# 词典使用指南

Dict-Hub 支持 MDX/MDD 格式的词典文件，这是 MDict 软件广泛使用的词典格式。

## 支持的格式

### MDX 文件

MDX 是词典数据文件，包含词条和释义内容。

- 文件扩展名：`.mdx`
- 内容格式：HTML 或纯文本
- 支持图片、CSS 样式等资源

### MDD 文件

MDD 是词典资源文件，通常包含音频、图片等媒体资源。

- 文件扩展名：`.mdd`
- 常见用途：单词发音音频
- 可以有多个 MDD 文件对应一个 MDX

## 目录结构

词典文件需要放置在正确的目录：

```
dicts/
├── source/              # MDX 词典文件目录
│   ├── 牛津高阶英汉双解词典.mdx
│   ├── 朗文当代高级英语词典.mdx
│   └── Collins COBUILD.mdx
│
└── sound/               # MDD 音频文件目录
    ├── 牛津发音.mdd
    └── Longman Pronunciation.mdd
```

### 目录说明

| 目录 | 用途 | 配置项 |
|------|------|--------|
| `dicts/` | 词典根目录 | `MDX_DICT_DIR` |
| `dicts/source/` | MDX 词典文件 | `MDX_SOURCE_DIR` |
| `dicts/sound/` | MDD 音频文件 | `MDX_SOUND_DIR` |

## 添加词典

### 方法一：直接复制文件

1. 将 MDX 文件复制到 `dicts/source/` 目录
2. 将 MDD 文件复制到 `dicts/sound/` 目录（如有）
3. 重启 Dict-Hub 服务

### 方法二：通过设置页面

1. 访问设置页面：http://localhost:8080/settings
2. 点击「重新加载词典」按钮
3. 系统会自动扫描并加载新词典

## 词典管理

### 查看已加载词典

在设置页面可以查看所有已加载的词典：

- 词典名称
- 词条数量
- 加载状态

### 启用/禁用词典

点击词典旁的开关可以启用或禁用特定词典：

- **启用**：词典会出现在搜索结果中
- **禁用**：词典不参与搜索，但仍保留在系统中

### 词典排序

搜索结果中的词典显示顺序取决于：

1. 词典加载顺序
2. 匹配精确度

## 音频播放

### 音频查找规则

Dict-Hub 使用智能算法查找单词发音：

1. 精确匹配单词
2. 大小写变体匹配
3. 去除特殊字符匹配

### 支持的音频格式

- MP3
- WAV
- OGG
- SPAX（部分 MDD 使用的压缩格式）

### 音频配置

确保 MDD 文件放在正确目录：

```yaml
mdx:
  sound_dir: ./dicts/sound
```

## 获取词典文件

### 合法来源

请从合法渠道获取词典文件：

1. **官方发布**：部分词典出版商提供电子版
2. **开源词典**：如 CC-CEDICT、EDICT 等
3. **自制词典**：使用 MdxBuilder 工具制作

### 推荐词典

以下是一些常用的英语学习词典：

| 词典名称 | 特点 |
|----------|------|
| 牛津高阶英汉双解词典 | 权威、例句丰富 |
| 朗文当代高级英语词典 | 词频标注、搭配丰富 |
| 柯林斯 COBUILD | 整句释义、自然语料 |
| 韦氏大学词典 | 美式英语标准 |

## 常见问题

### 词典无法加载

1. 检查文件格式是否正确（.mdx/.mdd）
2. 检查文件是否损坏
3. 查看日志确认错误原因：
   ```bash
   docker logs dict-hub | grep -i "error\|mdx"
   ```

### 音频无法播放

1. 确认 MDD 文件在 `sound` 目录
2. 检查 MDD 文件是否包含对应单词的音频
3. 部分词典的音频在 MDX 内嵌

### 中文乱码

1. 确认词典文件编码为 UTF-8
2. 部分旧版词典可能使用 GBK 编码

## 制作词典

如需制作自己的词典，可以使用：

- **MdxBuilder**：官方词典制作工具
- **writemdict**：Python 库，编程创建词典

基本流程：

1. 准备词条数据（TXT 格式）
2. 使用工具转换为 MDX
3. 可选：打包音频资源为 MDD
